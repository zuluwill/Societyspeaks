{% extends "layout.html" %}
{% from "components/discussion_card.html" import discussion_card %}

{% block head %}
    <title>News Discussions - SocietySpeaks</title>
    <meta name="description" content="Join discussions on trending news topics. Curated from trusted sources for thoughtful debate.">
    <link rel="canonical" href="{{ url_for('discussions.news_feed', _external=True) }}">
{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
    <div class="mb-8">
        <div class="flex items-center gap-3 mb-2">
            <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/>
            </svg>
            <h1 class="text-3xl font-bold text-gray-900">News Discussions</h1>
        </div>
        <p class="text-gray-600">Trending topics from trusted sources, curated for thoughtful public debate</p>
    </div>

    {% if topic_filter %}
    <div class="mb-4">
        <a href="{{ url_for('discussions.news_feed') }}" class="inline-flex items-center text-sm text-blue-600 hover:text-blue-800">
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
            </svg>
            View all topics
        </a>
    </div>
    {% endif %}

    <div class="bg-white rounded-lg shadow-sm p-4 mb-8">
        <div class="flex flex-wrap gap-2">
            <a href="{{ url_for('discussions.news_feed') }}" 
               class="px-3 py-1.5 rounded-full text-sm font-medium transition {% if not topic_filter %}bg-blue-600 text-white{% else %}bg-gray-100 text-gray-700 hover:bg-gray-200{% endif %}">
                All
            </a>
            {% for topic in topics %}
            <a href="{{ url_for('discussions.news_feed', topic=topic) }}" 
               class="px-3 py-1.5 rounded-full text-sm font-medium transition
               {% if topic_filter == topic %}
                   {% if topic == 'Healthcare' %}bg-emerald-600 text-white
                   {% elif topic == 'Environment' %}bg-green-600 text-white
                   {% elif topic == 'Education' %}bg-blue-600 text-white
                   {% elif topic == 'Technology' %}bg-purple-600 text-white
                   {% elif topic == 'Economy' %}bg-yellow-600 text-white
                   {% elif topic == 'Politics' %}bg-red-600 text-white
                   {% elif topic == 'Society' %}bg-orange-600 text-white
                   {% elif topic == 'Infrastructure' %}bg-gray-600 text-white
                   {% elif topic == 'Geopolitics' %}bg-indigo-600 text-white
                   {% elif topic == 'Business' %}bg-teal-600 text-white
                   {% elif topic == 'Culture' %}bg-pink-600 text-white
                   {% else %}bg-slate-600 text-white{% endif %}
               {% else %}bg-gray-100 text-gray-700 hover:bg-gray-200{% endif %}">
                {{ topic }}
            </a>
            {% endfor %}
        </div>
    </div>

    {% if discussions.items %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for discussion in discussions.items %}
            {{ discussion_card(discussion) }}
        {% endfor %}
    </div>

    {% if discussions.pages > 1 %}
    <div class="mt-8 flex justify-center">
        <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px" aria-label="Pagination">
            {% if discussions.has_prev %}
            <a href="{{ url_for('discussions.news_feed', page=discussions.prev_num, topic=topic_filter) }}" 
               class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">
                <span class="sr-only">Previous</span>
                <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
            </a>
            {% endif %}

            {% for page_num in discussions.iter_pages(left_edge=2, left_current=2, right_current=3, right_edge=2) %}
                {% if page_num %}
                <a href="{{ url_for('discussions.news_feed', page=page_num, topic=topic_filter) }}"
                   class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium {% if page_num == discussions.page %}text-blue-600 bg-blue-50{% else %}text-gray-700 hover:bg-gray-50{% endif %}">
                    {{ page_num }}
                </a>
                {% else %}
                <span class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700">...</span>
                {% endif %}
            {% endfor %}

            {% if discussions.has_next %}
            <a href="{{ url_for('discussions.news_feed', page=discussions.next_num, topic=topic_filter) }}"
               class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">
                <span class="sr-only">Next</span>
                <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                </svg>
            </a>
            {% endif %}
        </nav>
    </div>
    {% endif %}
    {% else %}
    <div class="text-center py-12 bg-white rounded-lg shadow-sm">
        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/>
        </svg>
        <h3 class="mt-4 text-lg font-medium text-gray-900">No news discussions yet</h3>
        <p class="mt-2 text-gray-500">Check back soon - we're curating the latest topics for debate.</p>
        <div class="mt-6">
            <a href="{{ url_for('discussions.search_discussions') }}" 
               class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700">
                Explore All Discussions
            </a>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
