{% extends "layout.html" %}
{% block title %}API Playground - Society Speaks{% endblock %}
{% block meta_description %}Try the Society Speaks Partner API from your browser. Interactive requests for lookup, snapshot, and oEmbed with clear steps for developers and publishers.{% endblock %}

{% block content %}
<div class="bg-gradient-to-b from-blue-50 to-white">
  <div class="mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8">
    <header class="space-y-4">
      <nav class="text-sm text-gray-500">
        <a href="{{ url_for('partner.hub') }}" class="hover:text-blue-600">For Publishers</a>
        <span class="mx-2">/</span>
        <a href="{{ url_for('partner.api_docs') }}" class="hover:text-blue-600">API Reference</a>
        <span class="mx-2">/</span>
        <span class="text-gray-900">API Playground</span>
      </nav>
      <div class="grid gap-6 lg:grid-cols-12 lg:items-center">
        <div class="lg:col-span-8 space-y-3">
          <h1 class="text-2xl font-bold text-gray-900 sm:text-3xl">API Playground</h1>
          <p class="text-gray-600">
            Try the Partner API from your browser. Requests are sent to this site. Create Discussion requires an API key.
            Get test keys in the <a href="{{ url_for('partner.portal_signup') }}" class="text-blue-600 hover:underline">Partner Portal</a>.
          </p>
          <div class="flex flex-wrap gap-3">
            <a href="{{ url_for('partner.api_docs') }}" class="inline-flex items-center rounded-md bg-white px-4 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">
              Read API Docs
            </a>
            <a href="{{ url_for('partner.portal_signup') }}" class="inline-flex items-center rounded-md bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500">
              Get API keys
            </a>
          </div>
        </div>
        <div class="lg:col-span-4">
          <div class="rounded-xl border border-blue-100 bg-white p-5 shadow-sm">
            <p class="text-xs font-semibold uppercase tracking-wide text-blue-600">How to use</p>
            <ol class="mt-3 space-y-2 text-sm text-gray-700">
              <li>Choose an endpoint on the left.</li>
              <li>Click <strong>Try it out</strong> and set parameters.</li>
              <li>For Create Discussion, use <strong>Authorize</strong> with your X-API-Key.</li>
            </ol>
          </div>
        </div>
      </div>
    </header>
  </div>
</div>

<div class="mx-auto max-w-7xl px-4 pb-10 sm:px-6 lg:px-8">
  <div id="swagger-ui" class="rounded-lg border border-gray-200 overflow-hidden bg-white"></div>
</div>

<link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui.css">
<script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-bundle.js" crossorigin></script>

<script>
  window.onload = function() {
    if (typeof SwaggerUIBundle === 'undefined') {
      document.getElementById('swagger-ui').innerHTML =
        '<div class="p-8 text-center text-gray-500">' +
        '<p class="text-lg font-semibold mb-2">Failed to load API Playground</p>' +
        '<p>The Swagger UI library could not be loaded. Please refresh the page or try again later.</p>' +
        '</div>';
      return;
    }
    window.ui = SwaggerUIBundle({
      url: "{{ url_for('partner.openapi_spec') }}",
      dom_id: '#swagger-ui',
      presets: [
        SwaggerUIBundle.presets.apis,
        SwaggerUIBundle.SwaggerUIStandalonePreset
      ],
      layout: "BaseLayout",
      deepLinking: true,
      tryItOutEnabled: true
    });
  };
</script>
{% endblock %}
